<!-- Modal Backdrop with Blur Effect -->
<div *ngIf="show" class="modal-backdrop" (click)="onClose()">
  
  <!-- Modal Container -->
  <div class="modal-container" (click)="$event.stopPropagation()">
    
    <!-- Modal Header -->
    <div class="modal-header">
      <h3>{{ title }}</h3>
      <button type="button" class="close-btn" (click)="onClose()">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- Modal Body -->
    <form (ngSubmit)="onSubmit()" class="modal-body">
      
      <!-- Email Field -->
      <div class="form-group">
        <label>Email *</label>
        <input 
          type="email" 
          [(ngModel)]="userForm.email"
          name="email"
          required
          placeholder="user@company.com">
      </div>

      <!-- Full Name Field -->
      <div class="form-group">
        <label>Full Name *</label>
        <input 
          type="text" 
          [(ngModel)]="userForm.fullName"
          name="fullName"
          required
          placeholder="John Doe">
      </div>

      <!-- Role Field -->
      <div class="form-group">
        <label>Role *</label>
        <select 
          [(ngModel)]="userForm.role"
          name="role"
          required>
          <option value="Profil">Profile</option>
          <option value="HSE">HSE</option>
          <option value="Admin">Admin</option>
        </select>
      </div>

      <!-- Company ID Field -->
      <div class="form-group">
        <label>Company ID *</label>
        <input 
          type="text" 
          [(ngModel)]="userForm.companyId"
          name="companyId"
          required
          placeholder="TE1234">
      </div>

      <!-- Department Field -->
      <div class="form-group">
        <label>Department *</label>
        <select 
          [(ngModel)]="userForm.department"
          name="department"
          required>
          <option value="">Select Department</option>
          <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
        </select>
      </div>

      <!-- Position Field -->
      <div class="form-group">
        <label>Position *</label>
        <input 
          type="text" 
          [(ngModel)]="userForm.position"
          name="position"
          required
          placeholder="Job Title">
      </div>

      <!-- Error Message -->
      <div *ngIf="error" class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        {{ error }}
      </div>

      <!-- Role Information -->
      <div class="role-info">
        <i [class]="getRoleIcon()"></i>
        <span>{{ getRoleDescription() }}</span>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
        <button type="button" class="btn-cancel" (click)="onClose()">
          Cancel
        </button>
        <button 
          type="submit" 
          class="btn-submit"
          [disabled]="isLoading || !isFormValid()">
          <i *ngIf="isLoading" class="fas fa-spinner fa-spin"></i>
          {{ isLoading ? 'Creating...' : submitButtonText }}
        </button>
      </div>
      
    </form>
  </div>
</div>